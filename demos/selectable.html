<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8' />
	<meta name="viewport" content="width=device-width, user-scalable=no">
	<link href='../fullcalendar.css' rel='stylesheet' />
	<link href='../fullcalendar.print.css' rel='stylesheet' media='print' />
	<script src='../lib/moment.min.js'></script>
	<script src='../lib/jquery.min.js'></script>
	<script src='../fullcalendar.min.js'></script>
	<script src='../lib/jquery-ui.js'></script>
	<script src="./js/inputDialog.js"></script>
<style>

	body {
		margin: 40px 10px;
		padding: 0;
		font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
		font-size: 14px;
	}

	#calendar {
		max-width: 900px;
		margin: 0 auto;
	}

	.hidden{
		visibility: hidden;
	}

	.show{
		visibility: visible;
	}

	.absolute{
		position: absolute;
	}

	.info{
		width:200px;
		height:100px;
		background-color: white;
		z-index: 999999;
		-webkit-box-shadow: 3px 3px 5px 0px rgba(0,0,0,0.75);
		-moz-box-shadow: 3px 3px 5px 0px rgba(0,0,0,0.75);
		box-shadow: 3px 3px 5px 0px rgba(0,0,0,0.75);
		padding:15px;
	}

</style>
</head>
<body>

	<div id="inputDialog" class="hidden absolute info">
		<input type="text" id="title" placeholder="제목"/>
		<p id="datetime"></p>
		<input type="text" placeholder="팀원"/><br>
		<input type="button" id="btnCreate" value="create"/>
		<input type="button" id="btnCancel" value="cancel"/>
	</div>

	<div id="showEvent" class="hidden absolute info">


	</div>

	<div id='calendar'></div>

	<input type='button' id='btnAddEvent' value = 'addEvent'/>

	<input type='text' id='search'/>

	<input type='button' id='btnSearch' value = 'Search'/>

	<script>

		dom = $('#calendar');
		app = {

			function insertEvent(){
				console.log("insert");
			}
		}

		inputDialog.init(app);
/*
		var eventsData = [
			{
				id:'9999',
				className:'my',
				title: 'All Day Event',
				start: '2016-05-01'
			},
			{
				id:'9999',
				className:'my',
				title: 'Long Event',
				start: '2016-05-07',
				end: '2016-05-10'
			},
			{
				id:'9999',
				className:'my',
				id: 999,
				title: 'Repeating Event',
				start: '2016-05-09T16:00:00'
			},
			{
				className:'my',
				id: 999,
				title: 'Repeating Event',
				start: '2016-05-16T16:00:00'
			},
			{
				title: 'Conference',
				start: '2016-05-11',
				end: '2016-05-13'
			},
			{
				title: 'Meeting',
				start: '2016-05-12T10:30:00',
				end: '2016-05-12T12:30:00'
			},
			{
				title: 'Lunch',
				start: '2016-05-12T12:00:00'
			},
			{
				title: 'Meeting',
				start: '2016-05-12T14:30:00'
			},
			{
				title: 'Happy Hour',
				start: '2016-05-12T17:30:00'
			},
			{
				title: 'Dinner',
				start: '2016-05-12T20:00:00'
			},
			{
				title: 'Birthday Party',
				start: '2016-05-13T07:00:00',
				resources: [
					{
						id: 'a',
						title: 'Room A'
					},
					{
						id: 'a1',
						parentId: 'a',
						title: 'Room A1'
					},
					{
						id: 'a2',
						parentId: 'a',
						title: 'Room A2'
					}]
			},
			{
				title: 'Click for Google',
				url: 'http://google.com/',
				start: '2016-05-28'
			}
		];

		//달력 데이터 초기화
		function calInit( _json){
			$('#calendar').fullCalendar({
				header: {
					left: 'prev,next today',
					center: 'title',
					right: 'month,agendaWeek,agendaDay'
				},
				defaultDate: '2016-05-12',
				selectable: true,
				selectHelper: false,
				select: function(start, end, jsEvent){
					console.log(start);
					showInsertEventDivRange(start, end, jsEvent);

				},
				editable: true,
				eventLimit: true, // allow "more" link when too many events
				events: _json
			});
		}

		calInit(eventsData);

		function calAddEvent(_json){
			dom.fullCalendar('addEventSource', _json);
		}

		function calRemoveEvent(_json){
			dom.fullCalendar( 'removeEvents' );
		}

		function calUpdateEvent(_json){

		}

		function searchAddEvent(_json){

		}

		function clickEvent(){

		}

		function showEventDiv(_title, _startDate, _endDate, _x, _y){

		}

		function showInsertEventDivRange(_start, _end, _event){


			app.domPopup = $('#insertEvent');
			app.domPopup.switchClass('hidden', 'show');
			app.domPopup.css({
				left: _event.pageX,
				top: _event.pageY
			});




			$('#calendar').fullCalendar('unselect');
			$('#calendar').fullCalendar('refetchEvents');



		}

		function showInsertEventDiv(_daydom, _x, _y) {

			app.domPopup = $('#insertEvent');
			app.domPopup.switchClass('hidden', 'show');
			app.domPopup.css({
				left: _x - app.domPopup.width() / 2 + _daydom.width() / 2,
				top: _y - app.domPopup.height()
			});


			var eventData;
			if (title) {
				eventData = {
					title: app.domPopup.find("#title").val(),
					start: start,
					end: end
				};
				$('#calendar').fullCalendar('renderEvent', eventData, true); // stick? = true
			}
			$('#calendar').fullCalendar('unselect');



		}

		function cancel(){

		}

		function dialogInit(){
			app.domPopup.find("#create").click(function(){
				var title  = app.domPopup.find("#title").val();
				var eventData;
				console.log(title)
				console.log(_start._d);
				console.log(_end._d)

				if (title) {
					eventData = {
						title: title,
						start: _start._d,
						end: _end._d
					};
					console.log(eventData);
					//$('#calendar').fullCalendar('addEventSource', [eventData]); // stick? = true
					$('#calendar').fullCalendar('renderEvent', eventData, true);

					//app.domPopup.find("#title").val(null);

				}

			});

			app.domPopup.find("#cancel").click(function(){
				app.domPopup.switchClass("show", "hidden");
			});
		}*/


	</script>
</body>
</html>
